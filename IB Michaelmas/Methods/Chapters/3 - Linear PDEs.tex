\documentclass[../Main.tex]{subfiles}

\begin{document}
\section{Superposition}
We will be interested in solving Boundary-Value problems (BVPs) and Initial Boundary-Value problems (IBVPs):
\begin{equation}
    \begin{cases}
        P\phi(\vec{x}) = 0 & \vec{x} \in \Omega \\
        \text{Appropriate boundary conditions} & \vec{x} \in \partial \Omega
    \end{cases}
    \label{eqnGeneralBVP}
\end{equation}
\begin{equation}
    \begin{cases}
        Q\phi(\vec{x}, t) = 0 & (\vec{x}, t) \in \Omega \times (0, T) \\
        \text{Appropriate initial conditions} & (\vec{x}, t) \in \Omega \times \{t = 0\} \\
        \text{Appropriate boundary conditions} & (\vec{x}, t) \in \partial \Omega \times (0, T)
    \end{cases}
    \label{eqnGeneralIBVP}
\end{equation}
Where here $P, Q$ are \underline{linear partial differential operators} and $\Omega$ is a bounded, open subset of $\R^n$.

Note that we can split equation~\ref{eqnGeneralIBVP} into:
\begin{align*}
    &\begin{cases}
        Q\phi_1(\vec{x}, t) = 0 & (\vec{x}, t) \in \Omega \times (0, T) \\
        \text{Initial conditions} = 0 & (\vec{x}, t) \in \Omega \times \{t = 0\} \\
        \text{Appropriate boundary conditions} & (\vec{x}, t) \in \partial \Omega \times (0, T)
    \end{cases} \\
    &\begin{cases}
        Q\phi_2(\vec{x}, t) = 0 & (\vec{x}, t) \in \Omega \times (0, T) \\
        \text{Appropriate initial conditions} & (\vec{x}, t) \in \Omega \times \{t = 0\} \\
        \text{boundary conditions} = 0 & (\vec{x}, t) \in \partial \Omega \times (0, T)
    \end{cases}
\end{align*}
and then $\phi = \phi_1 + \phi_2$ is a valid solution.

In this course, $\Omega$ will always be (possibly after a change of variables) a line/rectangle/cuboid. So without loss of generality we can always deal with boundary conditions that are zero everywhere except from on one endpoint/edge/face. For example:
\begin{equation}
    \begin{cases}
        P\psi(\vec{x}) = 0 & x \in (0, 1) \times (0, 1) \\
        \psi = f_i & \text{ on side } i \in \{1, \cdots, 4\}
    \end{cases}
    \label{eqneqnBVPSquare}
\end{equation}
and we can split this into 4 functions $\psi_i$:
\begin{equation*}
    \begin{cases}
        P\psi_i(\vec{x}) = 0 & \vec{x} \in (0, 1)^2 \\
        \psi_i = 0 & \text{on side } \neq i \\
        \psi_i = f_i & \text{on side } = i
    \end{cases}
\end{equation*}
Then $\psi = \sum_{i=1}^4 \psi_i$ solves the problem.
\section{Laplace's Equation}
Recall Laplace's Equation for $\phi : \R^n \mapsto \R$:
\begin{equation}
    \Delta \phi = 0
    \label{eqnLaplace}
\end{equation}
where $\Delta = \nabla^2 = \nabla \cdot \nabla$. We say $\phi$ is \underline{harmonic} if it satisfies this equation. Harmonic functions are always infinitely differentiable (smooth).
\begin{example}[Incompressible irrotational fluid]
    Consider $\vec{u} : \R^3 \mapsto \R^3$ is a velocity field of an incompressible fluid ($\nabla u = 0$), and if it is also irrotational ($\nabla \times u = \vec{0}$), we can solve using Laplace's equation since there must exist a potential $\phi : \R^3 \mapsto \R$ such that $\vec{u} = \nabla \phi$. Then:
    \begin{equation*}
        0 = \nabla \cdot \vec{u} = \nabla \cdot (\nabla \phi) = \Delta \phi
    \end{equation*}
\end{example}
We now consider BVPs of the form:
\begin{equation*}
    \begin{cases}
        \Delta \phi(\vec{x}) = 0 & \vec{x} \in \Omega \\
        B\phi = f(\vec{x}) & \vec{x} \in \partial \Omega
    \end{cases}
\end{equation*}
where $B\phi = \phi$ (Dirichlet BCs), $B\phi = \frac{\partial \phi}{\partial \vec{n}}$ (Von Neumann BCs), or more generally $B\phi = \phi + \frac{\partial \phi}{\partial \vec{n}}$ (Robin BCs).
\subsection{Separation of Variables on a Square}
Consider:
\begin{equation*}
    \begin{cases}
        \phi_{xx} + \phi_{yy} = 0 & (x, y) \in (0, 1)^2 \\
        \phi(x, y) = 0 & \{\{0, 1\}, y\} \cup \{x, 0\} \\
        \phi(x, 1) = f(x) & y = 1
    \end{cases}
\end{equation*}
Now try a \underline{separable} solution of the form:
\begin{equation*}
    \phi = X(x) Y(y)
\end{equation*}
Then:
\begin{equation*}
    X''(x) Y(y) + X(x)Y''(y) = 0
\end{equation*}
Dividing through by $XY$:
\begin{align*}
    \frac{X''(x)}{X(x)} + \frac{Y''(y)}{Y(y)} &= 0 \\
    -\frac{X''(x)}{X(x)} = \lambda = \frac{Y''(y)}{Y(y)}
\end{align*}
because we have 2 terms with different dependences, so they may only be constant. We can now simultaneously solve the $x$ equation and the $y$ equation:
\begin{equation*}
    \begin{cases}
        X'' + \lambda X = 0 & x \in (0,1) \\
        X(x) = 0 & x \in \{0, 1\}
    \end{cases}
\end{equation*}
which is simply a Sturm-Liouville problem with $w = 1, p = 1, q = 0$. Therefore, there exist eigenfunction-eigenvalue pairs $(X_n, \lambda_n)$ with increasing $\lambda$ and orthogonality condition $\inn{X_n}{X_m} = 0$ for $n \neq m$.

After checking, we find that $\lambda > 0$ for non-trivial solutions. Then we can solve:
\begin{equation*}
    X(x) = A\sin(\sqrt{\lambda}x) + B\cos(\sqrt{\lambda}x)
\end{equation*}
then applying the boundary conditions gives $B = 0$, $\lambda = \lambda_n = (n\pi)^2$.
\begin{equation*}
    X_n(x) = \sin(n\pi x), \inn{X_n}{X_m} = \frac12 \delta_{mn}
\end{equation*}
Therefore the $y$ problem becomes:
\begin{equation*}
    Y'' - (n\pi)^2 Y = 0
\end{equation*}
and we solve this to get $Y(y) = B \sinh(n\pi y)$, or $Y_n(y) = B_n \sinh(n\pi y)$. Combining these together:
\begin{equation*}
    \phi_n(x, y) = A_n \sin(n\pi x) \sinh(n\pi x)
\end{equation*}
each satisfies $\Delta y_n = 0$ on $(x, y) \in (0,1)^2$ and $\phi_n = 0$ on $x = 0$, $x = 1$ and $y = 0$. Therefore, the most general solution $\phi$ is:
\begin{equation*}
    \phi(x, y) = \sum_{n = 1}^\infty A_n \sin(n\pi x) \sinh(n\pi x)
\end{equation*}
but we need to apply the final boundary condition, $\phi(x, 1) = f(x)$ Taking an inner product:
\begin{align*}
    \inn{f}{X_n} &= \sum_{m=0}^{\infty} A_m \inn{X_m}{X_n} \sinh(n\pi) \\
    &= \frac{A_n}{2}\sinh(n\pi) \\
    \therefore A_n &= \frac{2}{\sinh(n\pi)} \int_{0}^{1} f(x) \sin(n\pi x) dx 
\end{align*}
\subsection{Separation of Variables on a Disc}
We will solve $\Delta \phi = 0$ on the region $r_1 < |x| < r_2$ in the $(x, y)$ plane. Polar coordinates appear as an obvious choice for such a region. Then Laplace's equation becomes:
\begin{equation*}
    \frac{1}{r} \frac{\partial }{\partial r} \left(r \frac{\partial \phi}{\partial r}\right) + \frac{1}{r^2} \frac{\partial^{2}\phi}{\partial \theta^{2}} = 0
\end{equation*}
Now we look for a separable solution of the form $\phi = R(r) \Theta(\theta)$. Substituting this:
\begin{equation}
    \frac{1}{R}\frac{d}{dr}\left(r \frac{dR}{dr}\right) + \frac{1}{\Theta} \frac{d^{2}\Theta}{d\theta^{2}} = 0
    \label{eqnDiscSeparated}
\end{equation}
Therefore we can separate this, both must be equal to $\lambda \in \R$:
\begin{align*}
    r \frac{d}{dr}\left(r \frac{dR}{dr}\right) &= \lambda R \\
    \frac{d^{2}\Theta}{d\theta^{2}} + \lambda \Theta = 0
\end{align*}
Then we can find a solution to the theta equation:
\begin{equation*}
    \Theta(\theta) =
    \begin{cases}
        A \cos(\sqrt{\lambda}\theta) + B\sin(\sqrt{\lambda} \theta) & \lambda > 0 \\
        A\theta + B & \lambda = 0 \\
        A \cosh(\sqrt{-\lambda}\theta) + B\sinh(\sqrt{-\lambda} \theta) & \lambda < 0 \\
    \end{cases}
\end{equation*}
We need that $\Theta(\theta + 2\pi) = \Theta(\theta)$. Therefore, we require $\lambda = n^2$:
\begin{align*}
    \Theta_0 (\theta) &= A_0 \\
    \Theta_n(\theta) &= A_n \cos(n\theta) + B_n \sin(n\theta)
\end{align*}
Then substituting $\lambda = n^2$ in the equation for $R$:
\begin{equation*}
    r(rR')' = n^2 R
\end{equation*}
where the $'$ represents differentiation by $r$. For $n = 0$ we find:
\begin{equation*}
    R_0(r) = A + b\log(r)
\end{equation*}
For $n > 0$, we try $R(r) = r^\alpha$, so $\alpha^2 = n^2, \alpha = \pm n$.
The solution then looks like $R_n(r) = A_n' r^n + B_n' r^{-n}$. We now have a very general solution:
\begin{equation*}
    \phi(r, \theta) = A + B\log(r) + \sum_{n=0}^{\infty} \left[A_n'r^n + B_n' r^{-n}\right] \times \left[C_n \cos(n\theta) + D_n \sin(n\theta)\right]
\end{equation*}
However, the point $r = 0$ does not belong to the domain of this function. If we need this point, we have the constraint $B = B_n = 0$.
\begin{example}
    Solve $\Delta \phi = 0$ on $r_1 < r < r_2$, with boundary conditions $\phi = 0$ on $r = r_1$, and $\phi = f(\theta)$ on $r = r_2$.

    We can repeat the analysis but require $R_n(r_1) = 0$ for each $n$. Then we get:
    \begin{align*}
        R_0(r) &= \log\left(\frac{r}{r_1}\right) \\
        R_n(r) &= \left(\frac{r}{r_1}\right)^n - \left(\frac{r_n}{r}\right)^n
    \end{align*}
    And now our more general solution is:
    \begin{equation*}
        \phi(r, \theta) = C_0\log\left(\frac{r}{r_1}\right) + \sum_{n=1}^{\infty} \left[\left(\frac{r}{r_1}\right)^n - \left(\frac{r_1}{r}\right)^{n}\right]\left[A_n \cos(n\theta) + B_n \sin(n\theta)\right]
    \end{equation*}
    and the boundary condition at $r = r_2$ is:
    \begin{align*}
        f(\theta) &= C_0\log\left(\frac{r_2}{r_1}\right) + \sum_{n=1}^{\infty} \left[\left(\frac{r_2}{r_1}\right)^n - \left(\frac{r_1}{r_2}\right)^{n}\right]\left[A_n \cos(n\theta) + B_n \sin(n\theta)\right] \\
        &= \frac12 a_0 + \sum_{n=0}^{\infty} [a_n \cos(n\theta) + b_n\sin(n\theta)]
    \end{align*}
    So the RHS should be the Fourier series for $f$:
    \begin{align*}
        a_n &= \frac{1}{\pi}\int_{0}^{2\pi} f(\theta) \cos(n\theta) d\theta \\
        b_n &= \frac{1}{\pi}\int_{0}^{2\pi} f(\theta) \sin(n\theta) d\theta \\
    \end{align*}
\end{example}
Using the ideas in this example, we can also solve such a problem when we have $\phi(r_1, \theta) = f(\theta), \phi(r_2, \theta) = g(\theta)$ by superposing solutions like before.
\subsection{Separation of Variables on a Ball}
Now we consider $\Delta \phi = 0$ on the region $a < |\vec{x}| < b$ in $\R^3$. We assume that the problem is symmetric about the $z$ axis. That is, taking spherical polar coordinates $(r, \theta, \varphi)$ the function (or its boundary conditions) do not depend on $\varphi$. Laplace's Equation becomes:
\begin{equation*}
    \frac{1}{r^2} \frac{\partial }{\partial r}\left[r^2 \frac{\partial \phi}{\partial r}\right] + \frac{1}{r^2 \sin(\theta)} \frac{\partial}{\partial \theta} \left[\sin(\theta) \frac{\partial \phi}{\partial \theta}\right] = 0
\end{equation*}
Note here that we removed the last term. We now look for a separable solution $\phi = R(r) = \Theta(\theta)$. Then:
\begin{equation*}
    \frac{1}{R} \frac{d}{dr} \left[r^2 \frac{dR}{dr}\right] + \frac{1}{\Theta \sin(theta)} \frac{d}{d\theta} \left[\sin(\theta) \frac{d\Theta}{d\theta}\right]
\end{equation*}
So now we have $\lambda \in \R$ such that:
\begin{align*}
    [r^2 R']' &= \lambda R
    -[\sin(\theta) \Theta']' = \lambda \sin(\theta)
\end{align*}
Now, to solve the $\Theta$ equation, consider the new variable $x = \cos(\theta)$. Let $\tilde{\Theta}(x) = \Theta(\theta)$. Note that the operator $\frac{d}{d\theta} = -sin(\theta) \frac{d}{dx}$.
\begin{align*}
    \lambda \sin(\theta) \tilde{\Theta} &= -\left(-\sin(\theta) \frac{d}{dx}\right) \left[\sin(\theta) \left(-\sin(\theta) \frac{d\tilde{\Theta}}{dx}\right)\right] \\
    &= -\sin(\theta) \frac{d}{dx} \left[(1 - x^2) \frac{d\tilde{\Theta}}{dx}\right] \\
    \therefore -\frac{d}{dx} \left[(1 - x^2) \frac{d\tilde{\Theta}}{dx}\right] = \lambda \tilde{\Theta}
\end{align*}
But now we have Legendre's equation! This means we do not need any boundary conditions and we have $\tilde{\Theta}(x) = P_n(x)$ where $\lambda = \lambda_n = n(n+1)$. In terms of $\Theta$ and $\theta$,
\begin{equation*}
    \Theta_n(\theta) = P_n(\cos(\theta))
\end{equation*}
Now we can consider the $R$ equation:
\begin{equation*}
    [r^2 R']' = n(n+1)R
\end{equation*}
Trying a solution of the form $R^\alpha$ gives $\alpha(\alpha+1) = n(n+1)$. The solutions are $\alpha = n$ and $\alpha = -(n+1)$. The general solution is then:
\begin{equation*}
    \phi(r, \theta) = \sum_{n=0}^{\infty} \left(\alpha_n r^n + \frac{\beta_n}{r^{n+1}}\right) P_n(\cos(\theta))
\end{equation*}
And note that if $r = 0$ belongs to the domain, all the $\beta_n$ are zero.
\begin{example}
    We consider $\Delta \phi = 0$ on $r < 1$ and $\phi(r, \theta) = f(\theta)$. We can now try a solution of the form:
    \begin{equation*}
        \phi(r, \theta) = \sum_{n=0}^{\infty} \alpha_nr^n P_n(\cos(\theta))
    \end{equation*}
    The boundary condition is then:
    \begin{equation*}
        f(\theta) = \sum_{n=0}^{\infty} \alpha_n P_n(\cos(\theta))
    \end{equation*}
    Recall that all the $P_n$ are orthogonal with respect to the inner product:
    \begin{equation*}
        \inn{P_n}{P_m} = \int_{-1}^{1} P_n(x)P_m(x) dx = \frac{2}{2n+1}\delta_{nm}
    \end{equation*}
    Then setting $x = \cos(\theta)$:
    \begin{equation*}
        \frac{2}{2n+1}\delta_{nm} = \int_{0}^{\pi} P_n(\cos{\theta}) P_m (\sin{\theta}) d\theta
    \end{equation*}
    Therefore we can determine the $\alpha_n$:
    \begin{align*}
        \int_{0}^{\pi} f(\theta)P_m(\cos{\theta}) \sin(\theta) d\theta &= \sum_{n=0}^{\infty} \alpha_n \inn{P_n}{P_m} \\
        &= \frac{2\alpha_m}{2m+1} \\
        \implies \alpha_n &= \left(\frac{2n+1}{2}\right) \int_{0}^{\pi} f(\theta) P_n(\cos{\theta}) \sin{\theta} d\theta
    \end{align*}
\end{example}
\end{document}