\documentclass[../Main.tex]{subfiles}

\begin{document}
\section{Superposition}
We will be interested in solving Boundary-Value problems (BVPs) of the form in equation~\ref{eqnGeneralBVP} and Initial Boundary-Value problems (IBVPs) of the form in equation~\ref{eqnGeneralIBVP}
\begin{equation}
    \begin{cases}
        P\phi(\vec{x}) = 0 & \vec{x} \in \Omega \\
        \text{Appropriate boundary conditions} & \vec{x} \in \partial \Omega
    \end{cases}
    \label{eqnGeneralBVP}
\end{equation}
\begin{equation}
    \begin{cases}
        Q\phi(\vec{x}, t) = 0 & (\vec{x}, t) \in \Omega \times (0, T) \\
        \text{Appropriate initial conditions} & (\vec{x}, t) \in \Omega \times \{t = 0\} \\
        \text{Appropriate boundary conditions} & (\vec{x}, t) \in \partial \Omega \times (0, T)
    \end{cases}
    \label{eqnGeneralIBVP}
\end{equation}
Where here $P, Q$ are \underline{linear partial differential operators} and $\Omega$ is a bounded, open subset of $\R^n$.

Note that we can split equation~\ref{eqnGeneralIBVP} into:
\begin{align*}
    &\begin{cases}
        Q\phi_1(\vec{x}, t) = 0 & (\vec{x}, t) \in \Omega \times (0, T) \\
        \text{Initial conditions} = 0 & (\vec{x}, t) \in \Omega \times \{t = 0\} \\
        \text{Appropriate boundary conditions} & (\vec{x}, t) \in \partial \Omega \times (0, T)
    \end{cases} \\
    &\begin{cases}
        Q\phi_2(\vec{x}, t) = 0 & (\vec{x}, t) \in \Omega \times (0, T) \\
        \text{Appropriate initial conditions} & (\vec{x}, t) \in \Omega \times \{t = 0\} \\
        \text{boundary conditions} = 0 & (\vec{x}, t) \in \partial \Omega \times (0, T)
    \end{cases}
\end{align*}
and then $\phi = \phi_1 + \phi_2$ is a valid solution.

In this course, $\Omega$ will always be (possibly after a change of variables) a line/rectangle/cuboid. So without loss of generality we can always deal with boundary conditions that are zero everywhere except from on one endpoint/edge/face. For example:
\begin{equation}
    \begin{cases}
        P\psi(\vec{x}) = 0 & x \in (0, 1) \times (0, 1) \\
        \psi = f_i & \text{ on side } i \in \{1, \cdots, 4\}
    \end{cases}
    \label{eqneqnBVPSquare}
\end{equation}
and we can split this into 4 functions $\psi_i$:
\begin{equation*}
    \begin{cases}
        P\psi_i(\vec{x}) = 0 & \vec{x} \in (0, 1)^2 \\
        \psi_i = 0 & \text{on side} \neq i \\
        \psi_i = f_i & \text{on side} = i
    \end{cases}
\end{equation*}
Then $\psi = \sum_{i=1}^4 \psi_i$ solves the problem.
\section{Laplace's Equation}
Recall Laplace's Equation for $\phi : \R^n \mapsto \R$:
\begin{equation}
    \Delta \phi = 0
    \label{eqnLaplace}
\end{equation}
where $\Delta = \nabla^2 = \nabla \cdot \nabla$. We say $\phi$ is \underline{harmonic} if it satisfies this equation. Harmonic functions are always infinitely differentiable (smooth).
\begin{example}[Incompressible irrotational fluid]
    Consider $\vec{u} : \R^3 \mapsto \R^3$ a velocity field of an incompressible fluid ($\nabla \vec{u} = 0$). Suppose that it is also irrotational ($\nabla \times u = \vec{0}$). In this case we can find $\vec{u}$ using Laplace's equation since there must exist a potential $\phi : \R^3 \mapsto \R$ such that $\vec{u} = \nabla \phi$. Then:
    \begin{equation*}
        0 = \nabla \cdot \vec{u} = \nabla \cdot (\nabla \phi) = \Delta \phi
    \end{equation*}
\end{example}
We now consider BVPs of the form:
\begin{equation*}
    \begin{cases}
        \Delta \phi(\vec{x}) = 0 & \vec{x} \in \Omega \\
        B\phi = f(\vec{x}) & \vec{x} \in \partial \Omega
    \end{cases}
\end{equation*}
where $B\phi = \phi$ (Dirichlet BCs), $B\phi = \frac{\partial \phi}{\partial \vec{n}}$ (Von Neumann BCs), or more generally $B\phi = \phi + \frac{\partial \phi}{\partial \vec{n}}$ (Robin BCs).
\subsection{Separation of Variables on a Square}
Consider Laplace's equation on a square with boundary conditions:
\begin{equation*}
    \begin{cases}
        \phi_{xx} + \phi_{yy} = 0 & (x, y) \in (0, 1)^2 \\
        \phi(x, y) = 0 & \text{Sides } x = 0, y = 0, x = 1 \\
        \phi(x, 1) = f(x) & \text{Side }y = 1
    \end{cases}
\end{equation*}
Now try a \underline{separable} solution of the form:
\begin{equation*}
    \phi = X(x) Y(y)
\end{equation*}
Then:
\begin{equation*}
    X''(x) Y(y) + X(x)Y''(y) = 0
\end{equation*}
Dividing through by $XY$:
\begin{align*}
    \frac{X''(x)}{X(x)} + \frac{Y''(y)}{Y(y)} &= 0 \\
    \implies -\frac{X''(x)}{X(x)} &= \lambda = \frac{Y''(y)}{Y(y)}
\end{align*}
because we have 2 terms with different dependences, so they may only be constant. We can now simultaneously solve the $x$ equation and the $y$ equation:
\begin{equation*}
    \begin{cases}
        X'' + \lambda X = 0 & x \in (0,1) \\
        X(x) = 0 & x \in \{0, 1\}
    \end{cases}
\end{equation*}
which is simply a Sturm-Liouville problem with $w = 1, p = 1, q = 0$. Therefore, there exist eigenfunction-eigenvalue pairs $(X_n, \lambda_n)$ with increasing $\lambda$ and orthogonality condition $\inn{X_n}{X_m} = 0$ for $n \neq m$.

After checking, we find that $\lambda > 0$ for non-trivial solutions. Then we can solve:
\begin{equation*}
    X(x) = A\sin(\sqrt{\lambda}x) + B\cos(\sqrt{\lambda}x)
\end{equation*}
then applying the boundary conditions gives $B = 0$, $\lambda = \lambda_n = (n\pi)^2$.
\begin{equation*}
    X_n(x) = \sin(n\pi x), \inn{X_n}{X_m} = \frac12 \delta_{mn}
\end{equation*}
Therefore the $y$ problem becomes:
\begin{equation*}
    Y'' - (n\pi)^2 Y = 0
\end{equation*}
and we solve this to get $Y(y) = B \sinh(n\pi y)$, or $Y_n(y) = B_n \sinh(n\pi y)$. Combining these together:
\begin{equation*}
    \phi_n(x, y) = A_n \sin(n\pi x) \sinh(n\pi x)
\end{equation*}
Note that we only need one constant at the front (we set $A_n B_n \to A_n$).
Each satisfies $\Delta y_n = 0$ on $(x, y) \in (0,1)^2$ and $\phi_n = 0$ on $x = 0$, $x = 1$ and $y = 0$. Therefore, the most general solution $\phi$ is:
\begin{equation*}
    \phi(x, y) = \sum_{n = 1}^\infty A_n \sin(n\pi x) \sinh(n\pi x)
\end{equation*}
but we need to apply the final boundary condition, $\phi(x, 1) = f(x)$. Taking an inner product:
\begin{align*}
    \inn{f}{X_n} &= \sum_{m=0}^{\infty} A_m \inn{X_m}{X_n} \sinh(n\pi) \\
    &= \frac{A_n}{2}\sinh(n\pi) \\
    \therefore A_n &= \frac{2}{\sinh(n\pi)} \int_{0}^{1} f(x) \sin(n\pi x) dx 
\end{align*}
This is our solution, and so given a specific function $f$ we can find the value of each $A_n$ and a closed form for $\phi$.

In general, this is how we will proceed with solving these sorts of PDEs. We do the following:
\begin{enumerate}
    \item Try a separable solution and solve for each separate function
    \item Apply homogeneous boundary conditions (ones with $=0$) to the individual eigenfunctions
    \item Multiply the separable parts back together and sum over all possible eigenvalues (usually indexed by $n \in \N$ or $n \in \N \cup \{0\}$)
    \item Apply any non-homogeneous boundary conditions (ones with $=f$ for $f$ a function) using the relevant inner product.
\end{enumerate}
\subsection{Separation of Variables on a Disc}
We will solve $\Delta \phi = 0$ on the region $r_1 < |x| < r_2$ in the $(x, y)$ plane. Polar coordinates appear as an obvious choice for such a region. Then Laplace's equation becomes:
\begin{equation*}
    \frac{1}{r} \frac{\partial }{\partial r} \left(r \frac{\partial \phi}{\partial r}\right) + \frac{1}{r^2} \frac{\partial^{2}\phi}{\partial \theta^{2}} = 0
\end{equation*}
Now we look for a separable solution of the form $\phi = R(r) \Theta(\theta)$. Substituting this:
\begin{equation}
    \frac{1}{R}\frac{d}{dr}\left(r \frac{dR}{dr}\right) + \frac{1}{\Theta} \frac{d^{2}\Theta}{d\theta^{2}} = 0
    \label{eqnDiscSeparated}
\end{equation}
Therefore we can separate this, both must be equal to $\lambda \in \R$:
\begin{align*}
    r \frac{d}{dr}\left(r \frac{dR}{dr}\right) &= \lambda R \\
    \frac{d^{2}\Theta}{d\theta^{2}} + \lambda \Theta &= 0
\end{align*}
Then we can find a solution to the theta equation:
\begin{equation*}
    \Theta(\theta) =
    \begin{cases}
        A \cos(\sqrt{\lambda}\theta) + B\sin(\sqrt{\lambda} \theta) & \lambda > 0 \\
        A\theta + B & \lambda = 0 \\
        A \cosh(\sqrt{-\lambda}\theta) + B\sinh(\sqrt{-\lambda} \theta) & \lambda < 0 \\
    \end{cases}
\end{equation*}
We need that $\Theta(\theta + 2\pi) = \Theta(\theta)$. Therefore, we require $\lambda = n^2$:
\begin{align*}
    \Theta_0 (\theta) &= A_0 \\
    \Theta_n(\theta) &= A_n \cos(n\theta) + B_n \sin(n\theta)
\end{align*}
Then substituting $\lambda = n^2$ in the equation for $R$:
\begin{equation*}
    r(rR')' = n^2 R
\end{equation*}
where the $'$ represents differentiation by $r$. For $n = 0$ we find:
\begin{equation*}
    R_0(r) = A + b\log(r)
\end{equation*}
For $n > 0$, we try $R(r) = r^\alpha$, so $\alpha^2 = n^2, \alpha = \pm n$.
The solution then looks like $R_n(r) = A_n' r^n + B_n' r^{-n}$. We now have a very general solution:
\begin{equation*}
    \phi(r, \theta) = A + B\log(r) + \sum_{n=0}^{\infty} \left[A_n'r^n + B_n' r^{-n}\right] \times \left[C_n \cos(n\theta) + D_n \sin(n\theta)\right]
\end{equation*}
However, the point $r = 0$ does not belong to the domain of this function. If we need this point, we have the constraint $B = B_n = 0$.
\begin{example}
    Solve $\Delta \phi = 0$ on $r_1 < r < r_2$, with boundary conditions $\phi = 0$ on $r = r_1$, and $\phi = f(\theta)$ on $r = r_2$.

    We can repeat the analysis but require $R_n(r_1) = 0$ for each $n$. Then we get:
    \begin{align*}
        R_0(r) &= \log\left(\frac{r}{r_1}\right) \\
        R_n(r) &= \left(\frac{r}{r_1}\right)^n - \left(\frac{r_n}{r}\right)^n
    \end{align*}
    And now our more general solution is:
    \begin{equation*}
        \phi(r, \theta) = C_0\log\left(\frac{r}{r_1}\right) + \sum_{n=1}^{\infty} \left[\left(\frac{r}{r_1}\right)^n - \left(\frac{r_1}{r}\right)^{n}\right]\left[A_n \cos(n\theta) + B_n \sin(n\theta)\right]
    \end{equation*}
    and the boundary condition at $r = r_2$ is:
    \begin{align*}
        f(\theta) &= C_0\log\left(\frac{r_2}{r_1}\right) + \sum_{n=1}^{\infty} \left[\left(\frac{r_2}{r_1}\right)^n - \left(\frac{r_1}{r_2}\right)^{n}\right]\left[A_n \cos(n\theta) + B_n \sin(n\theta)\right] \\
        &= \frac12 a_0 + \sum_{n=0}^{\infty} [a_n \cos(n\theta) + b_n\sin(n\theta)]
    \end{align*}
    So the RHS should be the Fourier series for $f$:
    \begin{align*}
        a_n &= \frac{1}{\pi}\int_{0}^{2\pi} f(\theta) \cos(n\theta) d\theta \\
        b_n &= \frac{1}{\pi}\int_{0}^{2\pi} f(\theta) \sin(n\theta) d\theta \\
    \end{align*}
\end{example}
Using the ideas in this example, we can also solve such a problem when we have $\phi(r_1, \theta) = f(\theta), \phi(r_2, \theta) = g(\theta)$ by superposing solutions like before.
\subsection{Separation of Variables on a Ball}
Now we consider $\Delta \phi = 0$ on the region $a < |\vec{x}| < b$ in $\R^3$. We assume that the problem is symmetric about the $z$ axis. That is, taking spherical polar coordinates $(r, \theta, \varphi)$ the function (or its boundary conditions) do not depend on $\varphi$. Laplace's Equation becomes:
\begin{equation*}
    \frac{1}{r^2} \frac{\partial }{\partial r}\left[r^2 \frac{\partial \phi}{\partial r}\right] + \frac{1}{r^2 \sin(\theta)} \frac{\partial}{\partial \theta} \left[\sin(\theta) \frac{\partial \phi}{\partial \theta}\right] = 0
\end{equation*}
Note here that we removed the last term because there is no $\varphi$ dependence. We now look for a separable solution $\phi = R(r) \Theta(\theta)$. Then:
\begin{equation*}
    \frac{1}{R} \frac{d}{dr} \left[r^2 \frac{dR}{dr}\right] + \frac{1}{\Theta \sin(\theta)} \frac{d}{d\theta} \left[\sin(\theta) \frac{d\Theta}{d\theta}\right]
\end{equation*}
So now we have $\lambda \in \R$ such that:
\begin{align*}
    [r^2 R']' &= \lambda R
    -[\sin(\theta) \Theta']' = \lambda \sin(\theta)
\end{align*}
Now, to solve the $\Theta$ equation, consider the new variable $x = \cos(\theta)$. Let $\tilde{\Theta}(x) = \Theta(\theta)$. Note that the operator $\frac{d}{d\theta} = -\sin(\theta) \frac{d}{dx}$.
\begin{align*}
    \lambda \sin(\theta) \tilde{\Theta} &= -\left(-\sin(\theta) \frac{d}{dx}\right) \left[\sin(\theta) \left(-\sin(\theta) \frac{d\tilde{\Theta}}{dx}\right)\right] \\
    &= -\sin(\theta) \frac{d}{dx} \left[(1 - x^2) \frac{d\tilde{\Theta}}{dx}\right] \\
    \therefore -\frac{d}{dx} &\left[(1 - x^2) \frac{d\tilde{\Theta}}{dx}\right] = \lambda \tilde{\Theta}
\end{align*}
But now we have Legendre's equation! This means we do not need any boundary conditions, and we have $\tilde{\Theta}(x) = P_n(x)$ where $\lambda = \lambda_n = n(n+1)$. In terms of $\Theta$ and $\theta$,
\begin{equation*}
    \Theta_n(\theta) = P_n(\cos(\theta))
\end{equation*}
Now we can consider the $R$ equation:
\begin{equation*}
    [r^2 R']' = n(n+1)R
\end{equation*}
Trying a solution of the form $R^\alpha$ gives $\alpha(\alpha+1) = n(n+1)$. The solutions are $\alpha = n$ and $\alpha = -(n+1)$. The general solution is then:
\begin{equation*}
    \phi(r, \theta) = \sum_{n=0}^{\infty} \left(\alpha_n r^n + \frac{\beta_n}{r^{n+1}}\right) P_n(\cos(\theta))
\end{equation*}
And note that if $r = 0$ belongs to the domain, all the $\beta_n$ are zero.
\begin{example}
    We consider $\Delta \phi = 0$ on $r < 1$ and $\phi(1, \theta) = f(\theta)$. Since $r = 0$ is in the domain, set $\beta_n = 0$. Consider:
    \begin{equation*}
        \phi(r, \theta) = \sum_{n=0}^{\infty} \alpha_nr^n P_n(\cos(\theta))
    \end{equation*}
    The boundary condition is then:
    \begin{equation*}
        f(\theta) = \sum_{n=0}^{\infty} \alpha_n P_n(\cos(\theta))
    \end{equation*}
    Recall that all the $P_n$ are orthogonal with respect to the inner product:
    \begin{equation*}
        \inn{P_n}{P_m} = \int_{-1}^{1} P_n(x)P_m(x) dx = \frac{2}{2n+1}\delta_{nm}
    \end{equation*}
    Then setting $x = \cos(\theta)$:
    \begin{equation*}
        \frac{2}{2n+1}\delta_{nm} = \int_{0}^{\pi} P_n(\cos{\theta}) P_m (\cos{\theta})\sin(\theta) d\theta
    \end{equation*}
    Therefore we can determine the $\alpha_n$:
    \begin{align*}
        \int_{0}^{\pi} f(\theta)P_m(\cos{\theta}) \sin(\theta) d\theta &= \sum_{n=0}^{\infty} \alpha_n \inn{P_n}{P_m} \\
        &= \frac{2\alpha_m}{2m+1} \\
    \end{align*}
    \begin{equation*}
        \implies \alpha_n = \left(\frac{2n+1}{2}\right) \int_{0}^{\pi} f(\theta) P_n(\cos{\theta}) \sin{\theta} d\theta
    \end{equation*}
\end{example}
\section{Wave Equation}
Consider a taut string, under constant tension $\tau$, clamped at its ends $x = 0, L$. Let $y = y(x, t)$ denote vertical displacement of string. Assume that oscillations are transverse and the slope $|y_x| << 1$. Note that:
\begin{align*}
    |y(x, t)| &= \left|\int_{0}^{x} y_x(s, t) ds\right| \\
    &\leq \int_{0}^{x} |y_x(s, t)| ds << 1
\end{align*}
\begin{figure}
    \centering
    \begin{tikzpicture}[
        >=Latex, % Use LaTeX style arrowheads
        thick,
        font=\large
    ]

        % ==========================================
        % TOP DIAGRAM: The Sine Wave
        % ==========================================
        \begin{scope}[shift={(0, 5)}]
            % Axes
            \draw[->] (0,-1.5) -- (0, 2) node[above] {$y$};
            \draw[->] (-0.5,0) -- (8.5, 0) node[right] {$x$};
            
            % Wave (Sine approximation)
            \draw[line width=1.2pt] plot[domain=0:8, samples=100] (\x, {sin(\x*50)});
            
            % Origin point
            \fill (0,0) circle (3pt);
            
            % L point (at 2pi approx 7.2 in this scale, visually placed to match)
            \coordinate (L) at (7.2, 0);
            \fill (L) circle (3pt);
            \node[below=3pt] at (L) {$L$};
            
            % The Circle for the "Zoom" area
            % Located on the rising slope
            \coordinate (ZoomCenter) at (1.2, {sin(1.2*50)});
            \draw[line width=1pt] (ZoomCenter) circle (0.2cm);
            
            % Coordinate for the arrow start
            \coordinate (ArrowStart) at ($(ZoomCenter) + (-70:0.2)$);
        \end{scope}


        % ==========================================
        % BOTTOM DIAGRAM: The Zoomed Segment
        % ==========================================
        \begin{scope}[shift={(1, -1)}]
            
            % Define the curve points
            \coordinate (A) at (0, 0);       % Left point
            \coordinate (B) at (4, 2);       % Right point
            \coordinate (M) at (2, 1.2);     % Middle point (approx)
            
            % Draw the curve segment
            \draw[line width=1.5pt] (A) to[out=40, in=200] (B);
            
            % Points on curve
            \fill (A) circle (3pt);
            \fill (B) circle (3pt);
            \fill (M) circle (3pt);
            
            % --- LEFT POINT (A) DETAILS ---
            % Tangent Force Vector (Tau) - Pointing backwards/down-left
            \draw[->, line width=1.2pt] (A) -- +(-140:1.5cm) node[left] {$\tau$};
            
            % Horizontal dashed line
            \draw[dashed] (A) -- +(1.5, 0);
            
            % Angle Theta A
            % Draw arc
            \draw (A) +(35:0.6cm) arc (30:0:0.6cm); % Actually angle is vertically opposite usually, but matching sketch
            % Sketch shows angle between Horizontal and Tangent
            %\draw (0.6,0) arc (0:40:0.6); % Visual placeholder for the "slope" angle
            \node at (1.2, 0.3) {$\theta_A$};
            
            % Vertical dashed line to axis
            \draw[dashed, line width=0.8pt] (A) -- (0, -2) node[below] {$x_A$};
            
            
            % --- MIDDLE POINT (M) DETAILS ---
            \draw[dashed, line width=0.8pt] (M) -- (2, -2) node[below] {$x$};
            
            
            % --- RIGHT POINT (B) DETAILS ---
            % Tangent Force Vector (Tau) - Pointing forwards/up-right
            \draw[->, line width=1.2pt] (B) -- +(20:1.5cm) node[above right] {$\tau$};
            
            % Horizontal dashed line
            \draw[dashed] (B) -- +(1.5, 0);
            % Angle Theta B
            \draw (B) +(1.0,0) arc (0:20:1.0);
            \node (ThetaB) at ($(B) + (0.3, 1)$) {$\theta_B$};
            \draw[->] (ThetaB.south) -- ($(B) + (10:0.7)$);
            
            % Vertical dashed line to axis
            \draw[dashed, line width=0.8pt] (B) -- (4, -2) node[below] {$x_B$};
            
            
            % --- BOTTOM AXIS / DELTA X ---
            % The horizontal distance marker
            \draw[<->, line width=1pt] (0, -1.5) -- (4, -1.5)
                node[above, pos=0.6] {$\delta x$};
            
        \end{scope}

        % ==========================================
        % CONNECTING ARROW
        % ==========================================
        \draw[->, line width=1.2pt, shorten >= 10pt] (ArrowStart) -- ($(M) + (0, 1)$);

    \end{tikzpicture}
    \caption{Forces on an oscillating string}
    \label{figOscString}
\end{figure}
See figure~\ref{figOscString} for definitions of quantities. Since oscillations are transverse, we can resolve horizontally:
\begin{equation*}
    \tau \cos(\theta_B) - \tau \cos(\theta_A) = 0
\end{equation*}
This is consistent, since:
\begin{align*}
    \tan(\theta_A) &= \left(\frac{\partial y}{\partial x}\right)_A \\
    \cos(\theta_A) &= \frac{1}{\sqrt{1 + \left(\frac{\partial y}{\partial x}\right)_A^2}}
\end{align*}
Then the mass of the string is proportional to the length:
\begin{equation*}
    \int_{x_A}^{x_B} \sqrt{1 + y_x^2} dx \approx \delta x
\end{equation*}
So it is reasonable to assume that mass is $\mu~\delta x$ where $\mu > 0$ is the density.
Then resolve vertically and use Newton's 2nd Law:
\begin{equation*}
    \mu~\delta x \left.\frac{\partial^{2}y}{\partial t^{2}}\right|_x = \tau\sin(\theta_B) - \tau\sin(\theta_A)
\end{equation*}
Then we divide by $\tau$, and assume that $\tau = \tau\cos(\theta_A) = \tau\cos(\theta_B)$ to leading order:
\begin{align*}
    \mu~\delta x &\left.\frac{\partial^{2}y}{\partial t^{2}}\right|_x = \frac{\tau\sin(\theta_B)}{\tau \cos(\theta_B)} - \frac{\tau\sin(\theta_A)}{\tau \cos(\theta_A)} \\
    &= \left(\frac{\partial y}{\partial x}\right)_B - \left(\frac{\partial y}{\partial x}\right)_A \\
    \mu \left.\frac{\partial^{2}y}{\partial t^{2}}\right|_x &= \left.\frac{\partial^{2}y}{\partial x^{2}} \right|_{\zeta}
\end{align*}
The Mean Value Theorem was used at the last step, and $\zeta \in (x_A, x_B)$. We then take $\delta x \to 0$ and $\zeta \to x$.
\begin{equation}
    \frac{1}{c^2} \frac{\partial^{2}y}{\partial t^{2}} = \frac{\partial^{2}y}{\partial x^{2}}
    \label{eqnWave}
\end{equation}
We call $c$ the wave speed. We have already some boundary conditions $y(0, t) = y(L, t) = 0$, and we require initial conditions $y(x, 0) = f(x), y_t(x, 0) = g(x)$.
\subsection{Waves on a String}
We want to solve the IBVP:
\begin{equation*}
    \begin{cases}
        y_{tt} - c^2y_{xx} = 0 & (x, t) \in (0, L) \times (0, \infty) \\
        y(0, t) = 0 & t \in (0, \infty) \\
        y(L, t) = 0 & t \in (0, \infty) \\
        y(x, 0) = f(x) & x \in (0, L) \\
        y_t(x, 0) = g(x) & x \in (0, L)
    \end{cases}
\end{equation*}
We can try a separable solution $y(x, y) = X(x) T(t)$. We need $X(0) = X(L) = 0$. We obtain:
\begin{equation}
    \frac{\ddot{T}}{c^2T} = \frac{X''}{X}
    \label{eqnWaveSeparated}
\end{equation}
Then the $X$ equation is a Sturm-Liouville problem with solutions:
\begin{equation*}
    X_n = \sin\left(\frac{n\pi x}{L}\right), \lambda_n = \left(\frac{n\pi}{L}\right)^2
\end{equation*}
Then the $T$ equation becomes:
\begin{equation*}
    \ddot{T} + \left(\frac{n\pi c}{L}\right)^2 T = 0
\end{equation*}
This gives general solution:
\begin{equation*}
    T_n(t) = A_n \cos\left(\frac{n\pi c t}{l}\right) + B_n \sin\left(\frac{n\pi c t}{L}\right)
\end{equation*}
And we can superpose:
\begin{equation}
    y(x, t) = \sum_{n=0}^{\infty} \sin\left(\frac{n\pi x}{L}\right)\left[A_n \cos\left(\frac{n\pi c t}{L}\right) + B_n \sin\left(\frac{n \pi c t}{L}\right)\right]
    \label{eqnWaveSolution}
\end{equation}
Then this is a solution of the wave equation that satisfies the boundary conditions. It does not yet satisfy the initial conditions. Setting $t = 0$ in equation~\ref{eqnWaveSolution}:
\begin{align*}
    f(x) &= \sum_{n=1}^{\infty} A_n \sin\left(\frac{n \pi x}{L}\right) \\
    g(x) &= \sum_{n=1}^{\infty} \left(\frac{n\pi c}{L}\right)B_n \sin\left(\frac{n\pi x}{L}\right)
\end{align*}
These are sine series! By orthogonality, we can find the $A_n$ and $B_n$:
\begin{align*}
    A_n &= \frac{2}{L} \int_{0}^{l} f(x) \sin\left(\frac{n \pi x}{L}\right) dx \\
    B_n &= \left(\frac{L}{2\pi c}\right)\frac{2}{L} \int_{0}^{L} g(x) \sin\left(\frac{n \pi x}{L}\right) dx 
\end{align*}
\subsection{Waves on a Drum}
The higher-dimensional analogue of the wave equation is:
\begin{equation}
    \frac{1}{c^2} \frac{\partial^{2}\phi}{\partial t^{2}} = \Delta \phi
    \label{eqnWave3D}
\end{equation}
We will solve the IBVP on a drum, $\Omega = \subsetselect{(r, \theta)}{0 \leq r < 1, 0 \leq \theta < 2\pi}$:
\begin{equation}
    \begin{cases}
        \phi_{tt} - c^2 \Delta \phi & \Omega \times (0, \infty) \\
        \phi = 0 & \partial \Omega \times (0, \infty) \\
        \phi = f & \Omega \times (t = 0) \\
        \phi_t = g & \Omega \times (t = 0) \\
    \end{cases}
    \label{eqnWaveDrum}
\end{equation}
For simplicity, assume that $f$ and $g$ are only functions of $r$. Therefore, it is reasonable to assume that $\phi$ is independent of $\theta$ too. The wave equation becomes:
\begin{equation*}
    \frac{1}{c^2} \frac{\partial^{2}\phi}{\partial t^{2}} = \frac{1}{r} \frac{\partial}{\partial r}\left(r \frac{\partial \phi}{\partial r}\right)
\end{equation*}
Then we can now try a separable solution $\phi(r, t) = R(r) T(t)$ with $R(1) = 0$. Our separated equation becomes:
\begin{equation*}
    \frac{\ddot{T}}{c^2 T} = \frac{[rR']'}{rR}
\end{equation*}
So now there exists $\lambda$ such that:
\begin{align*}
    &\frac{d}{dr}\left[r \frac{dR}{dr}\right] = \lambda rR,~0 < r < 1 \\
    &\ddot{T} + c^2 \lambda T = 0
\end{align*}
We have already solved the Sturm-Liouville problem for $R$: this Bessel's Equation with $m = 0$. The solutions are, setting $m = 0$ in equation~\ref{eqnBesselSLSoln}:
\begin{equation*}
    R_k(r) = J_{0}(j_{0k} r)
\end{equation*}
Recall that evaluating this at $r = 1$ gives $R_k(1) = 0$ because $j_{0k}$ is the value at the $k$th zero of the Bessel function.

Now the equation in $T$ becomes:
\begin{equation*}
    \ddot{T} + (cj_{0k})^2 T = 0
\end{equation*}
This has general solution:
\begin{equation*}
    T_k(t) = A_k \cos(j_{0k}ct) + B_k \sin(j_{0k}ct)
\end{equation*}
\begin{equation}
    \phi(r, t) = \sum_{k=1}^{\infty} J_0(j_{0k}r) \left[A_k \cos(j_{0k}ct) + B_k \sin(j_{0k}ct)\right]
    \label{eqnWaveDrumSoln}
\end{equation}
This solves the wave equation and the boundary conditions. We need to satisfy the initial conditions:
\begin{align*}
    f(r) &= \sum_{k=1}^{\infty} A_k J_0(j_{0k}r) \\
    g(r) &= \sum_{k=1}^{\infty} B_k j_{0k} c J_0(k_{0k}r)
\end{align*}
Then recall that we have the orthogonality relation:
\begin{equation*}
    \inn{R_k}{R_l}_w = \frac12 J_0'(j_{0k})^2 \delta_{kl}
\end{equation*}
And the by orthogonality we can find the coefficients $A_n$ and $B_n$:
\begin{align*}
    A_k &= \frac{2}{J_0'(j_{0k})^2} \int_{0}^{1} f(r) J_0(j_{0k}r) r dr \\
    B_k &= \frac{2}{J_0'(j_{0k})^2} \frac{1}{cj_{0k}} \int_{0}^{1} g(r) J_0(j_{0k}r)r dr
\end{align*}
\subsection{Energy Conservation and Uniqueness}
We will now show how energy conservation allows us to show uniqueness for the wave equation.

Begin on the string, with tension $\tau$, density $\mu$, and clamped at $x \in \{0, L\}$. Define the energy:
\begin{equation*}
    E(t) = \int_{0}^{L} \left[\frac12 \mu y_t^2 + \frac12 \tau y_x^2\right] dx = T + V
\end{equation*}
The second term in the integral is the potential energy stored in the string. We know that potential energy is proportional to the extension of the string, so on a small length of the string:
\begin{align*}
    ds - dx &= \left(\sqrt{1 + y_x^2} - 1\right) dx \\
    &\approx \frac{1}{2}y_x^2 dx
\end{align*}
For simplicity, set $\mu = 1$ so $\tau = c^2$ and the energy, after scaling, is:
\begin{equation*}
    E(t) = \frac12 \int_{0}^{L} \left[y_t^2 + c^2 y_x^2\right] dx
\end{equation*}
For the wave equation on a general domain $\Omega \times (0, \infty)$,
\begin{equation*}
    E(t) = \frac12 \int_{\Omega} \left[\phi_t^2 + c^2 |\nabla\phi|^2\right]dV
\end{equation*}
Recall our IBVP for the wave equation:
\begin{equation}
    \begin{cases}
        \phi_{tt} - c^2 \Delta \phi & \Omega \times (0, \infty) \\
        \phi = 0 & \partial \phi \times (0, \infty) \\
        \phi = f & \phi \times (t = 0) \\
        \phi_t = g & \phi \times (t = 0) \\
    \end{cases}
    \tag{\ref{eqnWaveDrum}}
\end{equation}
We can now look at the evolution of the energy as $\phi$ evolves according to equation~\ref{eqnWaveDrum} (our IBVP),
\begin{align*}
    \frac{dE}{dt} &= \int_{\Omega} \left(\phi_t \phi_{tt} + c^2 \nabla \phi \cdot \nabla \phi_t\right) dV \\
    &= c^2\int_{\Omega} \left(\phi_t \Delta \phi + c^2 \nabla \phi \cdot \nabla \phi_t\right) dV \text{by equation~\ref{eqnWave3D}} \\
    &= c^2 \int_{\Omega} \nabla \cdot \left(\phi_t\nabla \phi\right) \\
    &= c^2 \int_{\partial \Omega} \phi_t \frac{\partial \phi}{\partial \vec{n}} dS
\end{align*}
We know that $\phi(\vec{x}, t) = 0$ on $\partial \Omega$, so its time derivative must also be zero on the boundary. This gives:
\begin{equation*}
    \frac{dE}{dt} = 0
\end{equation*}
Therefore $E$ takes the same value at all time that it did at $0$, $E(t) = E(0)$. From the initial conditions, we find:
\begin{equation*}
    E(t) = E(0) = \frac12 \int_{\Omega} \left(g^2 + c^2 |\nabla f|^2\right) dV
\end{equation*}
\begin{proposition}
    The solution to equation~\ref{eqnWaveDrum} is unique.
    \label{propWaveUnique}
\end{proposition}
\begin{proof}
    Suppose both $\phi_1$ and $\phi_2$ satisfy equation~\ref{eqnWaveDrum}. Consider their difference:
    \begin{equation*}
        \psi = \phi_1 - \phi_2
    \end{equation*}
    Then $\psi$ satisfies equation~\ref{eqnWaveDrum}, with $f = g = 0$. By the conservation of energy:
    \begin{align*}
        0 = E(0) = E(t) &= \frac12 \int_\Omega \left(\psi_t^2 + c^2 |\nabla \psi|^2\right) dV
    \end{align*}
    But the integrand is certainly non-negative, so must be zero. $\psi_t = |\nabla \psi| = 0$ which implies that $\psi$ is constant on $\Omega$. However, since $\psi = 0$ on $\partial \psi$, we must have that $\psi = 0$ and $\phi_1 = \phi_2$.
\end{proof}
\subsection{Wave Reflection and Transmission}
Consider an infinite string, with constant tension $\tau$ and density $\mu_+$ on $x > 0$, density $\mu_-$ on $x < 0$. The equations of motion are:
\begin{equation*}
    \begin{cases}
        \frac{1}{c_-^2}\frac{\partial^{2}y}{\partial t^{2}} = \frac{\partial^{2}y}{\partial x^{2}} & x < 0 \\
        \frac{1}{c_+^2}\frac{\partial^{2}y}{\partial t^{2}} = \frac{\partial^{2}y}{\partial x^{2}} & x < 0 \\
    \end{cases}
\end{equation*}
In the above, $c_{\pm}^2 = \tau / \mu_{\pm}$. Now consider, for $\omega \in \R$, an incoming wave from $x < 0$ of the form:
\begin{align*}
    y(x, t) &= \cos\left[\omega \left(t - \frac{x}{c_-}\right)\right] \\
    &= \text{Re} \left[e^{i\omega(t - x/c_-)}\right]
\end{align*}
Then we expect to get wave transmission and reflection due to interactions at $x = 0$. We need to impose some physical conditions to get the solutions we want:
\begin{enumerate}
    \item The string does not break:
        \begin{equation*}
            y(0^+, t) = y(0^-, t)
        \end{equation*}
    \item Forces at $x = 0$ must be equal (because this single point has no mass):
        \begin{align*}
            \tau \sin(\theta_+) &= \tau \sin(\theta_-) \\
            \frac{\partial y}{\partial x}(0^+, t) &= \frac{\partial y}{\partial x} (0^-, t)
        \end{align*}
        If there were a mass at this point, we would need Newton's 2nd Law.
\end{enumerate}
We consider $y(x, t) = e^{i\omega (t - x / c_-)}$ as our solution. Given that all of our equations are real-valued, we know that the real part and the imaginary part of this will satisfy the equations separately. Therefore, we will deal with this complex function and take real parts at the end.

Consider solutions of the form:
\begin{equation*}
    y(x, t) =
    \begin{cases}
        e^{i\omega(t - \frac{x}{c_-})} + Re^{-\omega(t - \frac{x}{c_-})} & x < 0 \\
        Te^{-\omega (t - \frac{x}{c_+})} & x > 0
    \end{cases}
\end{equation*}
By the first boundary condition:
\begin{equation*}
    e^{i\omega t} + Re^{i\omega t} = Te^{i\omega t}
\end{equation*}
By the second boundary condition:
\begin{equation*}
    \frac{i\omega}{c_-} e^{i\omega t} (R - 1) = -\frac{i\omega}{c_+} Te^{-\omega t}
\end{equation*}
Then setting $\lambda = c_+ / c_- = \sqrt{\mu_- / \mu_+}$ to get our coefficients:
\begin{equation*}
    R = \frac{\lambda - 1}{\lambda + 1},~~T = \frac{2\lambda}{\lambda + 1}
\end{equation*}
We call $R$ the \underline{reflection coefficent}, and $T$ the \underline{transmission coefficient}.
To check, we can consider some extreme cases:
\begin{itemize}
    \item If $\mu_+ = \mu_-$, $\lambda = 1$ and $R = 0, T = 1$. That is, the wave passes straight thorugh the origin (because now the two sides are the same).
    \item If $\mu_+ >> \mu_-$, we find that $\lambda << 1$ so $R \approx -1$ and $T \approx 0$. This is (in the limit), a fixed end which changes the phase by $\pi$ and reflects the wave.
    \item If $\mu_- >> \mu_+$, $\lambda >> 1$, we find $R \approx 1$ and $T \approx 2$.
\end{itemize}
\section{The Heat Equation}
We want to model the temperature, $\phi(x, t)$, of a conductive material as it evolves over time. This must satisfy the \underline{heat equation}:
\begin{equation}
    \frac{\partial \phi}{\partial t} \kappa \Delta\phi
    \label{eqnHeat}
\end{equation}
The general idea behind this equation is that the heat should in general average out over time, so the rate of change at a given point is proportional to the average temperature around it. $\kappa > 0$ can be understood to measure conductivity of the material. Let the domain of the conducting material be $\Omega$. Then we have the IBVP:
\begin{equation}
    \begin{cases}
        \phi_t - \kappa \Delta\phi = 0 & \Omega \times (0, \infty) \\
        \phi = 0 & \partial \Omega \times (0, \infty) \\
        \phi = f & \Omega \times \{t = 0\}
    \end{cases}
    \label{eqnHeatIBVP}
\end{equation}
We can use our standard method of taking $\phi(\vec{x}, t) = T(t) \psi(\vec{x})$. We find that:
\begin{align}
    \dot{T} + \kappa \mu T &= 0 \label{eqnHeatTime} \\
    -\Delta \psi &= \mu \psi \label{eqnHeatSpace} \\
\end{align}
We get the simple solution for time, $T(t) = e^{-\kappa \mu t}$. We now need to solve the BVP:
\begin{equation}
    \begin{cases}
        -\Delta \psi = \mu \psi & \vec{x} \in \Omega \\
        \psi = 0 & \vec{x} \in \partial \Omega
    \end{cases}
    \label{eqnHeatBVP}
\end{equation}
Then the solutions to this BVP depend on the geometry of the conducting domain $\Omega$.
\subsection{Heat Conduction on a Square Sheet}
Consider $\Omega = \{(x, y) \in (0, L) \times (0, L)\}$. Then we can separate $\psi(\vec{x})$ into $\psi(\vec{x}) = X(x)Y(y)$. We find:
\begin{align*}
    X'' + \lambda X &= 0 \\
    Y'' + (\mu - \lambda) Y = 0
\end{align*}
with boundary conditions:
\begin{align*}
    X(0) &= X(L) = 0 \\
    Y(0) &= Y(L) = 0
\end{align*}
We are familiar with problems like this. They have solutions:
\begin{equation*}
    X_n(X) = \sin\left(\frac{n \pi x}{L}\right),~\lambda_n = \left(\frac{n\pi}{L}\right)^2
\end{equation*}
Use these eigenvalues to solve the equation for $Y$:
\begin{equation*}
    Y = A\sin\left(y\sqrt{\mu - \lambda_n}\right) + B\cos\left(y\sqrt{\mu - \lambda_n}\right) \\
\end{equation*}
Then apply the boundary conditions. $y(0) = 0 \implies B = 0$. $Y(L) = 0$ gives:
\begin{equation*}
    \mu_{mn} - \lambda_n = \left(\frac{n\pi}{L}\right)^2
\end{equation*}
This gives the solutions:
\begin{equation*}
    Y_n(y) = \sin\left(\frac{m \pi y}{L}\right),~~\mu_{mn} = \left(\frac{n\pi}{L}\right)^2 + \left(\frac{m \pi}{L}\right)^2
\end{equation*}
Now we are ready to write down our solution to $\phi$:
\begin{equation*}
    \phi(x, y, t) = \sum_{m, n = 1}^{\infty} A_{mn} e^{-\kappa \mu_{mn}t} \sin\left(\frac{n \pi x}{L}\right)\sin\left(\frac{m \pi x}{L}\right)
\end{equation*}
Then we have satisfied the condition for $t > 0$. We now apply the initial condition to determine $A_{mn}$:
\begin{equation*}
    f(x, y) = \sum_{m, n = 1}^{\infty} A_{mn} \sin\left(\frac{n \pi x}{L}\right) \sin\left(\frac{m \pi x}{L}\right)
\end{equation*}
Then we need two inner products to get $A$. Using equalities like $\inn{X_n, X_k} = \frac{L}{2} \delta_{nk}$:
\begin{equation*}
    A_{m, n} = \frac{2}{L} \frac{2}{L} \int_{0}^{L} \int_{0}^{L} f(x, y) \sin\left(\frac{n \pi x}{L}\right) \sin\left(\frac{n \pi x}{L}\right) dy  dx 
\end{equation*}
\subsection{Heat Flow Down a Pipe}
We now want to consider a pipe, so use cylindrical polars and define $\Omega$:
\begin{equation*}
    \Omega = \{(\rho, \phi, z) \vline 0 \leq \rho < 1, 0 \leq \phi < 2\pi, 0 < z < L\}
\end{equation*}
We now want to solve the IBVP in equation~\ref{eqnHeatIBVP}. For simplicity, assume $f$ depends only on $\rho, z$. We look for a solution of the form:
\begin{equation*}
    \phi(\rho, z, t) = T(t) \psi(\rho, z)
\end{equation*}
$\psi$ must satisfy:
\begin{align*}
    &-\Delta \psi = \mu \psi \\
    \implies &\frac{1}{\rho} \frac{\partial}{\partial \rho} \left(\rho \frac{\partial \psi}{\partial \rho}\right) + \frac{\partial^{2}\psi}{\partial z^{2}} + \mu \psi = 0
\end{align*}
Now we try another separable solution $\psi(\rho, z) = P(\rho) Z(z)$. Then we get that there exist eigenvalues $\lambda$ such that:
\begin{align*}
    -\frac{1}{\rho P} [\rho P']' &= \lambda \\
    Z'' + (\mu - \lambda) Z &= 0
\end{align*}
Our problem becomes:
\begin{align*}
    -\frac{d}{d\rho}\left[\rho \frac{dP}{d\rho}\right] = \lambda \rho P,~~&~0 < \rho < 1, P(1) = 0 \\
    Z'' + (\mu - \lambda) z = 0,~~&~Z(0) = Z(L) = 0
\end{align*}
The equation for $\rho$ is the Bessel problem with $m = 0$. Therefore it has solutions:
\begin{equation*}
    P_k(\rho) = J_0(j_{0k}\rho), \lambda_k = j_{0k}^2
\end{equation*}
The equation for $Z$ has solutions:
\begin{equation*}
    Z_n(z) = \sin\left(\frac{n \pi z}{L}\right), \mu_{kn} = \lambda_k +\left(\frac{n \pi}{L}\right)^2
\end{equation*}
Now we are ready to write down $\psi$:
\begin{equation*}
    \psi(\rho, z, t) = \sum_{n, k = 1}^{\infty} B_{nk} e^{-\kappa \mu_{nk} t} J_0(j_{0k}\rho) \sin\left(\frac{n \pi z}{L}\right)
\end{equation*}
This satisfies the heat equation and the boundary conditions. We use the initial conditions to determine $B_{nk}$:
\begin{equation*}
    f(\rho, z) = \sum_{n, k = 1}^{\infty} B_{nk} J_0(j_{0k} \rho) \sin\left(\frac{n \pi z}{L}\right)
\end{equation*}
Recall that $\int_{0}^{1} J_{0}(j_{0k} \rho) J_{0} (j_{0l} \rho) \rho d\rho = \frac12 J_0'(j_{0k})^2 \delta_{kl}$. Therefore we take inner products and find the constants:
\begin{equation*}
    B_{nk} = \frac{2}{J_0'(j_{0k})^2} \frac{2}{L} \int_{0}^{1} \int_{0}^{L} \rho f(\rho, z) J_0(j_{0k}\rho) \sin\left(\frac{n \pi z}{L}\right) dz  d\rho 
\end{equation*}
\subsection{Heat Loss and Uniqueness}
Like with the wave equation, we can consider an energy, the heat energy:
\begin{equation*}
    Q(t) = \frac12 \int_{\Omega} \phi(\vec{x}, t)^2 dV
\end{equation*}
Then we can find the derivative:
\begin{align*}
    Q'(t) &= \int_{\Omega} \phi_t \phi dV \\
    &= \int_{\Omega} \kappa \phi \Delta \phi \\
    &= \kappa \int_{\Omega} \left[\nabla \cdot (\phi \nabla \phi) - |\nabla \phi|^2\right]dV \\
    &= \kappa \int_{\partial \Omega} \phi \frac{\partial \phi}{\partial \vec{n}} dS  - \int_{\Omega} |\nabla \phi|^2 dV 
\end{align*}
Therefore $Q'(t) \leq 0$. Equivalently, $Q(t) \leq Q(0) = \frac{1}{2} \int_\Omega f(\vec{x})^2 dV$.
\begin{proposition}
    The solution to equation~\ref{eqnHeatIBVP} is unique.
    \label{propHeatUnique}
\end{proposition}
\begin{proof}
    Suppose that $\phi_1, \phi_2$ are solutions to equation~\ref{eqnHeatIBVP}. Then consider their difference $\psi$ which satisfoes equation~\ref{eqnHeatIBVP} with $f = 0$.

    \begin{equation*}
        \frac12 \int_\Omega \psi(\vec{x}, t)^2 dV = Q(t) \leq Q(0) = 0
    \end{equation*}
    Then this implies that $\psi(\vec{x}, t) = 0$ everywhere so $\phi_1 = \phi_2$.
\end{proof}
\begin{remark}
    There do exist problems for which $Q(t)$ does not exist. In this case, we cannot say that solutions are unique.
\end{remark}
\end{document}