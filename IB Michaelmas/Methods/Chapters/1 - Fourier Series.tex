\documentclass[../Main.tex]{subfiles}

\begin{document}
\section{Motivation}
After studing heat conduction in a rod, Joseph Forurier was studying $2\pi$ periodic functions.

He found that if a function has the form:
\begin{equation*}
    f(\theta) = \sum_n \hat{f}_n(\theta) e^{in\pi}
\end{equation*}
for $n \in \Z$, then the coefficients can found using a formula:
\begin{equation*}
    \hat{f}_n = \frac{1}{2\pi} \int_0^{2\pi} f(\theta) e^{-in\pi} d\theta
\end{equation*}
In fact, Fourier believed this worked for any $2\pi$-periodic function. He was not quite correct.
\section{Defining the Fourier Series}
Introduce a vector space $V$ of $L$-periodic functions. That is,
\begin{equation*}
    V = \subsetselect{f : \R \mapsto \C}{f\text{ is ``nice''}, f(\theta + L) = f(\theta)~\forall \theta \in \R}
\end{equation*}
Note that for $f \in V$, we need only consider values of $f$ taken in an interval of length $L$, such as $[0, L)$ or $(-\frac{L}{2}, \frac{L}{2}]$.

We define the inner product on V:
\begin{equation}
    \langle f~|~g\rangle = \int_0^L f(\theta) \bar{g(\theta)} d\theta
    \label{eqnInnerProdFuncs}
\end{equation}
We can also define a norm in the usual way, $||f|| = \sqrt{\langle f~|~f\rangle}$.

For $n \in \Z$ we also define $e_n \in V$ defined by:
\begin{equation}
    e_n(\theta) = e^\frac{2\pi in\theta}{L}
    \label{eqnFuncSpaceBasis}
\end{equation}
We can note the following:
\begin{align*}
    \langle e_n~|~e_m\rangle &= \int_0^L e^{2\pi i \frac{(n-m)\theta}{L}} d\theta \\
    &= L\delta_{nm}
\end{align*}
This tells us that this set of functions are orthogonal, each with norm $L$.

Recall from IA Vectors and Matrices that if $V_n$ is an $N$-dimensional vector space equipped with the dot product, with a set of vectors ${\vec{e_n}}_{n = 1}^N$ are orthogonal with $|\vec{e_n}|^2 = L$, then for each $\vec{x} \in V_N$ we can write it as a linear combination of this orthogonal set with coefficient $\hat{x}_n$. To find the coefficient of a single term in this linear combination, we can find the dot product $\vec{x} \cdot \vec{e_m} = \hat{x}_m \vec{e_m} \cdot \vec{e_m} = L\hat{x}_m$.

Now the question is, could this work on $V$, especially because $V$ has infinite dimensions?

We decide we do not care.

If we assume that $f \in V$ can be written in the form
\begin{equation}
    f(\theta) = \sum_n \hat{f}_n e_n(\theta)
    \label{eqnComplexFourierSeries}
\end{equation}
Then taking an inner product gives:
\begin{align*}
    \langle f~|~e_m\rangle &= \sum_n \hat{f}_n \langle e_n~|~e_m\rangle
    &= \sum_n \hat{f}_n L\delta_{mn} \\
    &= L\hat{f}_m
\end{align*}
Therefore,
\begin{equation}
    \hat{f}_n = \frac{1}{L}\langle f~|~e_n\rangle = \frac{1}{L} \int_0^L f(\theta) e^{-2\pi in\frac{\theta}{L}}d\theta
    \label{eqnComplexFourierCoefficients}
\end{equation}
\begin{warning}
    Here we implicitly interchanged an infinite integral and an infinite sum. This is fine, given our ``niceness'' condition.
\end{warning}
\begin{definition}{Complex Fourier Series}
    For $L$-periodic $f : \R \mapsto \C$, define its \underline{complex Fourier series} by equation~\ref{eqnComplexFourierSeries}, with coefficients given by equation~\ref{eqnComplexFourierCoefficients}.
\end{definition}
We will write,
\begin{equation*}
    f(\theta) \sim \sum_n \hat{f}_n e^{2\pi i n \frac{\theta}{L}}
\end{equation*}
to mean that the series on the RHS corresponds to the complex Fourier series for the function on the LHS. We would like to demonstrate equality here, but we are not there yet.

We can split the Fourier series into sines and cosines by splitting the sum:
\begin{align*}
    \sum_n \hat{f}_n e^{2\pi i n \frac{\theta}{L}} &= \hat{f}_0 + \sum_{n > 0} \hat{f}_n \left[\cos\left(\frac{2\pi i n \theta}{L}\right) + i\sin\left(\frac{2\pi n \theta}{L}\right)\right] \\
    &+ \sum_{n > 0} \hat{f}_{-n} \left[\cos\left(\frac{2\pi i n \theta}{L}\right) - i\sin\left(\frac{2\pi n \theta}{L}\right)\right] \\ 
    &= \hat{f}_0 + \sum_{n > 0} \left[a_n \cos\left(\frac{2\pi n \theta}{L}\right) + b_n \sin \left(\frac{2\pi n \theta}{L}\right)\right]
\end{align*}
where $a_n = \hat{f}_n + \hat{f}_{-n}, b_n = i (\hat{f}_n - \hat{f}_{-n})$.
\begin{definition}{Fourier Series}
    For $f : \R \mapsto \C$ and $L$-periodic define its \underline{Fourier series} by:
    \begin{equation}
        \frac{1}{2} a_0 + \sum_{n > 0} \left[a_n \cos\left(\frac{2\pi n \theta}{L}\right) + b_n \sin \left(\frac{2\pi n \theta}{L}\right)\right]
        \label{eqnFourierSeries}
    \end{equation}
    where:
    \begin{align*}
        a_n &= \frac{2}{L} \int_0^L f(\theta) \cos\left(\frac{2\pi n \theta}{L}\right)d\theta
        b_n &= \frac{2}{L} \int_0^L f(\theta) \sin\left(\frac{2\pi n \theta}{L}\right)d\theta
    \end{align*}
    are the Fourier coefficients for $f$.
\end{definition}
We can also consider a new set of vectors in our space $c_n(\theta) = \cos\left(\frac{2\pi n \theta}{L}\right)$ and $s_n(\theta) = \sin\left(\frac{2\pi n \theta}{L}\right)$. Then we also note that $\{1, c_n, s_n\}$ forms an orthogonal set in V.

\begin{example}
    Consider $f : \R \mapsto \R$, $1$-periodic such that $f(\theta) = \theta(1-\theta)$ on $[0, 1]$.

    For $n \neq 0$,
    \begin{align*}
        \hat{f}_n &= \int_0^1 \theta(1-\theta) e^{-2\pi i n \theta} d\theta \\
        &= -\left[\frac{\theta(1-\theta) e^{-2\pi i n \theta}}{2 \pi i n}\right]_0^1 + \frac{1}{2\pi i n} \int_0^1 (1 - 2\theta) e^{-2\pi i n \theta}d\theta \\
        &= -\left[\frac{(1-2\theta) e^{-2\pi i n \theta}}{(2 \pi i n)^2}\right]_0^1 + 0 \\
        &= -\frac{1}{2(\pi n)^2}
    \end{align*}
    and $\hat{f}_0 = \int_0^1 (\theta - \theta^2) d\theta = \frac16$.

    Therefore,
    \begin{equation*}
        f(\theta) \sim \frac{1}{6} - \frac{1}{2} \sum_{n \neq 0} \frac{e^{2\pi i n \theta}}{(n \pi)^2}
    \end{equation*}
\end{example}
\section{Convergence of Fourier Series}
The subject of convergence of Fourier series is extremely subtle. Results exist about the convergence of many different classes of functions, but the proofs are often difficult and unsuitable for this course.

\begin{definition}{Partial Fourier series}
    For $f : \R \mapsto \C$ $L$-periodic, define the \underline{partial Fourier series}:
    \begin{align*}
        (S_Nf)(\theta)&=\sum_{|n| \leq N} \hat{f}_n e^{2\pi i n \frac\theta{L}} \\
        &= \frac12 a_0 + \sum_{n = 1}^N \left[a_n \cos\left(\frac{2\pi n \theta}{L}\right) + b_n \sin\left(\frac{2 \pi n \theta}{L}\right)\right]
    \end{align*}
\end{definition}
We want to understand whether $(S_n f) \to f$. There are a few different convergence criteria we can consider:
\begin{itemize}
    \item \textbf{Pointwise convergence:} This is the simplest for of convergence to show but, as seen in Analysis II, is quite weak;
    \item \textbf{Uniform convergence:} this is a much stronger form of convergence, but would require a lot of work to show
    \item \textbf{Convergence in norm:} Given that we have already defined a norm for our set of functions, we could alternatively consider the norm $||S_n f - f||$ and require that it tends to $0$ as $N \to \infty$. As a reminder, the norm is:
        \begin{equation*}
            ||S_n f - f|| = \sqrt{\int_0^1 |(S_n f)(\theta) - f(\theta)|d\theta}
        \end{equation*}
        As an aside, this is a motivating problem for the topic of Hilbert Spaces that is covered in Part II Functional Analysis
\end{itemize}
\begin{theorem}[Pointwise convergence of Fourier Series]
    Let $f : \R \mapsto \C$ be $L$-periodic on $[0, L)$. Require:
    \begin{enumerate}
        \item $f$ has finitely many discontinuities
        \item $f$ has finitely many local maxima and minima
    \end{enumerate}
    Then for each $\theta \in [0, L)$,
    \begin{equation}
        \frac{f(\theta_+) + f(\theta_-)}{2} = \lim_{N \to \infty} (S_N f)(\theta) = \sum_n \hat{f}_n e^{2\pi i n \frac{\theta}{L}}
        \label{eqnFourierPointwise}
    \end{equation}
    Where $f(\theta_\pm) = \lim_{\epsilon \to 0} f(\theta \pm \epsilon)$.
    \label{thmFourierPointwise}
\end{theorem}
\begin{remarks}
    \item If there is not a discontinuity at $\theta_0$, the Fourier series returns $f(\theta_0)$
    \item If there is a discontinuity at $\theta_0$, the Fourier series returns the average of $f$ at either side of the discontinuity
    \item We call functions with the two properties above \underline{Dirichlet functions}
\end{remarks}
\begin{proof}[For $C^1$]
    For ease, assume $L = 2\pi$ and $\theta = 0$ WLOG by considering the new function $f(\theta - \theta_0)$.

    \begin{align*}
        (S_n f)(0) &= \sum_{|n| \leq N} \hat{f_n} e^{in \times 0} \\
        &= \sum_{|n| \leq N} \hat{f_n} \\
        &= \sum_{|n| \leq N} \left(\frac{1}{2\pi} \int_{-\pi}^\pi f(\theta) e^{-i n \theta} d\theta\right) \\
        &=\frac1{2\pi} \int_{-\pi}^\pi \left[\sum_{|n| \leq N} f(\theta) e^{-i n \theta}d\theta\right]
    \end{align*}
    Note that the sum is a geometric series:
    \begin{equation*}
        e^{iN\theta} \sum_{n = 0}^{2N} e^{-in\theta} = \frac{\sin\left[\left(N + \frac12\right)\right]}{\sin\left(\frac\theta{2}\right)}
    \end{equation*}
    note that this is equal to $2N + 1$ when $\theta \in 2\pi\Z$. We define this to be the \underline{Dirichlet kernel}
    \begin{equation*}
        D_N(\theta) =
        \begin{cases}
            \frac{\sin\left[\left(N + \frac12\right)\theta\right]}{\sin\left(\frac{\theta}{2}\right)} & \theta \in \R \backslash 2\pi \Z \\
            2N + 1 & \text{otherwise}
        \end{cases}
    \end{equation*}
    We note that, for each $N \geq 0$,
    \begin{enumerate}
        \item $D_N$ is continuous and $2\pi$-periodic
        \item $\int_{-\pi}^\pi D_N(\theta) d\theta = 2\pi$
    \end{enumerate}
    where here the second property is given by integrating the sum termwise.

    This means:
    \begin{equation*}
        f(0) =\frac{1}{2\pi} \int_{-\pi}^\pi D_n(\theta) f(0) d\theta
    \end{equation*}
    \begin{align*}
        (S_N f)(0) - f(0) &= \frac{1}{2\pi} \int_{-\pi}^\pi D_N(\theta) \left[f(\theta) - f(0)\right]d\theta \\
        &= \frac{1}{2\pi} \int_{-\pi}^\pi \sin\left[\left(N + \frac12\right)\theta\right] F(\theta) d\theta
    \end{align*}
    where:
    \begin{equation*}
        F(\theta) = \frac{\theta}{\sin\left(\frac{\theta}{2}\right)} \left[\frac{f(\theta - f(0))}{\theta}\right]
    \end{equation*}
    Note that $F(\theta)$ is smooth since:
    \begin{align*}
        \frac{f(\theta) - f(0)}{\theta}&= \frac{1}{\theta} \int_{0}^{\theta} f'(\tau) d\tau \\
        &= \frac{1}{\theta} \int_0^1 f'(\tau\theta) \theta d\tau \\
        &= \int_0^1 f'(\tau\theta) d\tau.
    \end{align*}
    Now integrating by parts:
    \begin{equation}
        (S_n f)(0) - f(0) = \frac{1}{N + \frac12} \frac{1}{2\pi} \int_{-\pi}^\pi \cos\left[\left(N + \frac12\right)\theta\right] F'(\theta) d\theta
        \label{eqnFourierPointwiseResult}
    \end{equation}
    and the RHS tends to $0$ as $N \to \infty$.
\end{proof}
\begin{remark}
    The proof becomes more difficuly when $f$ becomes less regular.
\end{remark}
\begin{example}
    Consider:
    \begin{equation*}
        f(\theta) =
        \begin{cases}
            1 & \theta \in [0, \pi) \\
            -1 & \theta \in [-\pi, 0)
        \end{cases}
    \end{equation*}
    and let it be $2\pi$-periodic.

    $f$ is odd so $a_n = 0$ in the Fourier series.
    \begin{align*}
        b_n&= \frac{2}{2\pi} \int_{-\pi}^\pi f(\theta) sin(n\theta) d\theta \\
        &= \frac{2}{\pi}\int_{0}^{\pi} f(\theta)\sin(n\theta) d\theta \\
        &= \frac{2}{n\pi} \left[\cos(n\theta)\right]_0^\pi \\
        &= \frac{2}{n\pi} \left[1 - (-1)^n\right]
    \end{align*}
    and so:
    \begin{equation*}
        f(\theta) \sim \frac{4}{\pi} \sum_{n \text{ odd}} \frac{\sin(n\theta)}{n}
    \end{equation*}
    note also that the series is $0$ at $\theta = 0$, which is the midpoint of $+1$ and $-1$.
\end{example}
\section{Further Concepts}
\subsection{Periodic Extensions}
Given $f : [0, L) \mapsto \C$, we can define $2L-periodic$ even/odd extensions $f_{even}$ and $f_{odd}$.

We simply let $f_{even}(\theta) = f(-\theta)$ when $\theta \in [-L, 0)$. Similarly, we let $f_{odd}(\theta) = -f(-\theta)$ on $[-L, 0)$.

The advantage of this is that now the function can be written as a Fourier series which, for the interval $[0, L)$, approximates the original function.
\begin{align*}
    f_{even} (\theta) &\sim \frac{1}{2} A_0 + \sum_{n = 1}^\infty A_n \cos\left(\frac{2\pi n \theta}{2L}\right) \\
    \text{where } A_n &= \frac{2}{2L} \int_{-L}^L f_{even}(\theta) \cos\left(\frac{2\pi n \theta}{2L}\right)d\theta \\
    &= \frac{2}{L}\int_{0}^{L} f(\theta)\cos\left(\frac{2\pi n \theta}{2L}\right) d\theta 
\end{align*}
and similarly,
\begin{align*}
    f_{odd} (\theta) &\sim \frac{1}{2} B_0 + \sum_{n = 1}^\infty B_n \sin\left(\frac{2\pi n \theta}{2L}\right) \\
    \text{where } B_n &= \frac{2}{2L} \int_{-L}^L f_{odd}(\theta) \sin\left(\frac{2\pi n \theta}{2L}\right)d\theta \\
    &= \frac{2}{L}\int_{0}^{L} f(\theta)\sin\left(\frac{2\pi n \theta}{2L}\right) d\theta 
\end{align*}
\begin{definition}{Cosine/Sine series}
    For $f : [0, L) \mapsto \C$, we define its \underline{cosine/sine series} as the even and odd periodic extensions as described above.
\end{definition}
\begin{example}
    Define the function:
    \begin{align*}
        f : [0, \pi) &\mapsto \C \\
        \theta &\mapsto 1
    \end{align*}
    For the sine series:
    \begin{equation*}
        B_n = \frac{2}{\pi} \int_{0}^{\pi} \sin(n\theta) d\theta = \frac{2}{n\pi}\left(1 - (-1)^n\right)
    \end{equation*}
    Then on $(0, \pi)$,
    \begin{align*}
        1 &= f(\theta) = f_{odd}(\theta) \\
        &= 4 \sum_{n~odd}^{} \frac{\sin(n\theta)}{n\pi}
    \end{align*}
    For the cosine series: $A_0 = 2$ and thereafter $A_n = 0$, so $f_{even}(\theta) = 1$.
\end{example}
\subsection{Regularity and Decay of Coefficients}
\begin{remark}
    The Riemann-Lebesgue lemma says that, if $g : [a, b] \mapsto \C$ is integrable on $[a, b]$ and $\lambda \in \R$, then:
    \begin{equation*}
        \int_{a}^{b} e^{-i\lambda \theta}g(\theta) d\theta \to 0 \text{ as } |\lambda| \to \infty
    \end{equation*}
    and this is non-examimable.

    Therefore if $f : \R \mapsto \C$ is $L$-periodic and integrable on $[0, L)$, then:
    \begin{equation*}
        \hat{f}_n = \frac{1}{L} \int_{0}^{L} e^{-2\pi i n \frac\theta{L}}f(\theta) d\theta \to 0
    \end{equation*}
    as $n \to \infty$.

    Further, the coefficients in the regular sine-and-cosine Fourier series also decay to $0$.
\end{remark}
Suppose now that $f$ is $L$-periodic and $f \in C^k(\R)$, $f$ is $k$-times continuously differentiable.

Then $\hat{f}_n = \frac{1}{L} \int_{0}^{L} e^{-2\pi i n \frac{\theta}{L}} f(\theta) d\theta$. Integrating by parts:
\begin{align*}
    \hat{f}_n &= -\frac{1}{L} \left(\frac{L}{2\pi i n}\right)\left[f(\theta) e^{-2\pi i n \frac{\theta}{L}} \right]_{\theta = 0}^L \\
    &+ \left(\frac{L}{2\pi i n}\right)\frac{1}{L}\int_{0}^{L} e^{-2\pi i n \frac{\theta}{L}}f'(\theta) d\theta \\
    &= -\left(\frac{L}{2\pi i n}\right) \left[\frac{f(L^-) - f(0^+)}{L}\right] \\
    &+ \left(\frac{L}{2\pi i n}\right)\frac{1}{L} \int_{0}^{L} e^{-2\pi i n \frac{\theta}{L}} f'(\theta) d\theta \\
\end{align*}
note that, by periodicity and continuity, $f(0^+) = f(L^+) = f(L^-)$. Therefore, the boundary term is zero. Repeating this process $k$ times:
\begin{equation*}
    hat{f}_n = \left(\frac{L}{2\pi i n}\right)\frac{1}{L} \int_{0}^{L} e^{-2\pi i n \frac{\theta}{L}} f^{(k)}(\theta) d\theta 
\end{equation*}
and by the Riemann-Lebesgue lemma, we have that $\hat{f}_n = o\left(\frac{1}{n^k}\right)$.
\subsection{Termwise differentiation}
Suppose $f$ is $L-periodic$ and continuously differentiable on $[0, L)$ with $f' = g$ there.

Then $g$ is continuous on $[0, L)$, so:
\begin{align*}
    \hat{g}_n &= \frac{1}{L} \int_{0}^{L} e^{-2\pi i n \frac{\theta}{L}} f'(\theta) d\theta \\
    &= \frac{f(L^-) - f(0^+)}{L} + \left(\frac{2\pi i n}{L}\right)\frac{1}{L} \int_{0}^{L} e^{-2\pi i n \frac{\theta}{L}}f(\theta) d\theta
\end{align*}
and so if $f$ is continuous on $\R$, then by periodicity and continuity the boundary term disappears, and:
\begin{equation*}
    \hat{g}_n = \left(\frac{2\pi i n}{L}\right) \hat{f}_n
\end{equation*}
this shows us that we can differentiate termwise:
\begin{align*}
    f'(\theta) &\sim \sum_n \left(\frac{2\pi i n}{L}\hat(f)_n e^{2\pi i n \frac{\theta}{L}}\right) \\
    &= \sum_n \frac{d}{d\theta} \left[\hat{f}_n e^{2\pi i n \frac{\theta}{L}}\right]
\end{align*}
\subsection{Parseval's Theorem}
If:
\begin{align*}
    f(\theta) &\sim \sum_n \hat{f}_n e_n(\theta) \\
    g(\theta) &\sim \sum_n \hat{g}_n e_n(\theta)
\end{align*}
where $e_n$ are defined as before, the inner product is:
\begin{align*}
    \langle f~|~g\rangle &= \sum_{n, m} \hat{f}_n \bar{\hat{g}_m} \langle e_n~|~e_m\rangle \\
    &= \sum_{n, m} \hat{f}_n \bar{\hat{g}_m} L \delta_{m, n} \\
    &= L\sum_{n} \hat{f}_n \bar{\hat{g}_n}
\end{align*}    
This means:
\begin{equation}
    \frac{1}{L}\int_{0}^{L} f(\theta) \bar{g(\theta)} d\theta = \sum_{n} \hat{f}_n \bar{\hat{g}_n}
    \label{eqnParseval}
\end{equation}
and this is Parseval's Theorem.
\begin{example}
    Let $f$ be $2\pi$-periodic, and let $f(\theta) = \theta$ on $[-\pi, \pi)$. This function has a jump discontinuity at $x \in \pi \Z$, and we can show that:
    \begin{equation*}
        f(\theta) \sim \sum_{n \neq 0} \frac{i(-1)^n}{n}e^{in\theta}
    \end{equation*}
    Then Parseval's Theorem of $f$ with itself says that:
    \begin{align*}
        \frac{\pi^2}{3} &= \frac{1}{2\pi} \int_{-\pi}^{\pi} \theta^2 d\theta \\
        &= \sum_{n \neq 0} \frac{1}{n^2} \\
        &= 2\sum_{n = 1}^\infty \frac{1}{n^2}
    \end{align*}
    which is a nice standard result.
\end{example}
\end{document}